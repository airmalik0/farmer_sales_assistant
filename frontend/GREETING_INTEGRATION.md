# 🌐 Интеграция управления приветствием на фронтенде

## ✨ Новые возможности в BroadcastModal

Теперь управление приветствием доступно прямо в интерфейсе создания рассылки!

### 🎛️ Функции управления приветствием:

1. **👀 Просмотр текущего приветствия**
   - Показывает активное приветствие из БД
   - Отображает статус (кастомное/стандартное)
   - Показывает включено/отключено

2. **⚙️ Настройка приветствия** 
   - Отдельный шаг в модалке для редактирования
   - Предпросмотр с подстановкой переменных
   - Сохранение в базу данных

3. **🗑️ Очистка приветствия**
   - Возврат к стандартному приветствию
   - Мгновенное обновление интерфейса

### 🔧 Технические изменения:

#### Новые API методы в `services/api.ts`:
```typescript
export const settingsApi = {
  getGreeting: () => api.get('/settings/greeting'),
  setGreeting: (greetingText: string, enabled: boolean = true) => 
    api.post('/settings/greeting', { greeting_text: greetingText, enabled }),
  updateGreeting: (greetingText?: string, enabled?: boolean) => 
    api.put('/settings/greeting', { ... }),
  clearGreeting: () => api.delete('/settings/greeting'),
  previewGreeting: (greetingText: string, firstName?: string, lastName?: string) => 
    api.get('/settings/greeting/preview', { params: { ... } })
}
```

#### Новые типы в `types/index.ts`:
```typescript
interface GreetingResponse {
  greeting_text: string;
  enabled: boolean;
  is_custom: boolean;
}

interface GreetingPreview {
  original: string;
  preview: string;
  variables: { first_name: string; last_name: string };
}
```

#### Обновленный BroadcastModal:
- **Убрано:** `customGreeting` из локального состояния
- **Добавлено:** Интеграция с API настроек  
- **Новый шаг:** `'greeting'` для управления приветствием
- **Предпросмотр:** Real-time превью с переменными

### 🎯 Пользовательский интерфейс:

#### В разделе "Составление сообщения":
```
✅ Включить персонализированное приветствие
   
   Управление приветствием        [👀 Посмотреть] [⚙️ Настроить]
   
   ┌─────────────────────────────────────────────────────┐
   │ Кастомное приветствие                    ✅ Включено │
   │ Привет, [Имя Клиента]! Как дела?                    │
   └─────────────────────────────────────────────────────┘
   
   Будет использовано кастомное приветствие из настроек
```

#### В разделе "Настройка приветствия":
```
   Настройка приветствия                       ✅ Включено
   
   ┌─────────────────────────────────────────────────────┐
   │ Текущее приветствие                     [🗑️ Очистить] │
   │ Привет, [Имя Клиента]! Как дела?                    │
   │ Кастомное приветствие                               │
   └─────────────────────────────────────────────────────┘
   
   Новое приветствие
   ┌─────────────────────────────────────────────────────┐
   │ Привет, [Имя Клиента]! Как дела у тебя?            │
   │                                                     │
   └─────────────────────────────────────────────────────┘
   Используйте переменные: [Имя Клиента], [Фамилия Клиента]
   
   ┌─────────────────────────────────────────────────────┐
   │ 👀 Предпросмотр                                     │
   │ Привет, Иван! Как дела у тебя?                      │
   │ Пример для: Иван Иванов                             │
   └─────────────────────────────────────────────────────┘
   
                    [◄ Назад]  [💾 Сохранить]
```

### 🔄 Синхронизация с ботом:

- ✅ **Единый источник данных:** База данных PostgreSQL
- ✅ **Real-time обновления:** Изменения сразу видны в боте  
- ✅ **Консистентность:** Нет конфликтов между интерфейсами
- ✅ **Персистентность:** Настройки сохраняются при перезапуске

### 🚀 Как использовать:

1. **Открыть модалку рассылки** в веб-интерфейсе
2. **Включить приветствие** галочкой
3. **Нажать "Настроить"** для изменения текста
4. **Ввести новое приветствие** с переменными
5. **Посмотреть предпросмотр** в реальном времени
6. **Сохранить изменения** - они сразу применятся в боте

### 🎉 Результат:

Теперь управление приветствием доступно и в боте, и на фронтенде с полной синхронизацией! 

- 🤖 **В Telegram боте:** `/menu` → "👋 Настроить приветствие"
- 🌐 **В веб-интерфейсе:** "Создать рассылку" → "⚙️ Настроить"
- 🔄 **Синхронизация:** Изменения мгновенно видны везде 